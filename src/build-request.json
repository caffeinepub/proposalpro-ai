{
  "kind": "build_request",
  "title": "Fix React runtime crash on Generate (Minified React error #185) and clear related runtime/type errors",
  "priority": "high",
  "requirements": [
    {
      "id": "REQ-10",
      "text": "Fix the runtime crash that occurs immediately after clicking “Generate Proposals” on /generate (Minified React error #185), ensuring the Generate flow completes and the Generated Content renders successfully.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-1"
        ],
        "quotes": [
          "Minified React error #185... When I am trying to generate proposals, this error is coming on the screen.",
          "Please fix it. Please clear all the errors and fix it, test it so that it's ready to use without any errors."
        ]
      },
      "acceptanceCriteria": [
        "From a logged-in session, clicking “Generate Proposals” on /generate does not crash the app and no React error overlay appears.",
        "After generation completes, the “Generated Content” section renders with all four output sections (Upwork Proposal, Cold Email Pitch, Short DM Pitch, Pricing Breakdown).",
        "No runtime exceptions occur from numeric comparisons/conversions related to entitlements or proposal generation state (e.g., BigInt vs number issues)."
      ]
    },
    {
      "id": "REQ-11",
      "text": "Normalize subscription/entitlements numeric values used in the UI so that comparisons and rendering are safe and consistent across the app (e.g., remaining free generations and total generations), and update Generate gating logic accordingly.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-1"
        ],
        "quotes": [
          "When I am trying to generate proposals, this error is coming on the screen."
        ]
      },
      "acceptanceCriteria": [
        "All places that compute `canGenerate` or compare remaining generations work without throwing (including when remaining generations are returned as BigInt-like values from the backend bindings).",
        "Quota UI (Generate page banner) correctly shows remaining generations and updates after a successful generation without errors.",
        "Account/Upgrade plan UI correctly shows remaining free generations and total generations without errors."
      ]
    },
    {
      "id": "REQ-12",
      "text": "Add a minimal regression test pass (manual QA checklist) to validate proposal generation, quota decrementing for Free users, and stability of the Generate/Dashboard/Proposal Detail pages after the fix.",
      "target": "both",
      "source": {
        "messageIds": [
          "msg-1"
        ],
        "quotes": [
          "Please clear all the errors and fix it, test it so that it's ready to use without any errors."
        ]
      },
      "acceptanceCriteria": [
        "Manual QA confirms: (1) Free user can generate until quota is exhausted; (2) quota decrements by 1 per generation; (3) when exhausted, user cannot generate and sees the appropriate messaging; (4) Premium user can generate without limits; (5) Saving a generated proposal works and it appears on Dashboard; (6) Viewing a saved proposal detail works; (7) Deleting a saved proposal works.",
        "No new backend traps are triggered unexpectedly during normal usage (other than intended authorization/quota traps)."
      ]
    }
  ],
  "constraints": [
    "Do not edit files in frontend immutablePaths: frontend/src/hooks/useInternetIdentity.ts, frontend/src/hooks/useInternetIdentity.tsx, frontend/src/hooks/useActor.ts, frontend/src/main.tsx, frontend/src/components/ui.",
    "Backend must remain single-actor with all Motoko logic in backend/main.mo.",
    "Use English for any user-facing text."
  ],
  "nonGoals": [
    "Adding new product features beyond fixing the Generate crash and clearing related errors.",
    "Integrating external AI services or changing the deterministic content generation approach.",
    "Changing authentication provider (Internet Identity remains the only auth)."
  ],
  "imageRequirements": {
    "required": [],
    "edits": []
  },
  "userProfileUpdate": {
    "goalsToAdd": [],
    "goalsToRemove": [],
    "preferencesToAdd": [],
    "preferencesToRemove": [],
    "miscToAdd": [],
    "miscToRemove": [],
    "fieldsToSet": {},
    "fieldsToDelete": []
  }
}